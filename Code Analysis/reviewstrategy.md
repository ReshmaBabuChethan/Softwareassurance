The Magento code is mostly written in PHP. There are many components in the systems like the payments, UI and the integration modules, etc. As this open-source software is available for a long time, many third party plugins can be installed and integrated with the software. The plugins typically use the API calls but are not included in the source code. There is a clear developer guide that will give instruction to all the contributors.

As the project codebase is huge, full manual review is not a feasible solution to completely review it. To complete the code review, we have decided to incorporate both the code review approaches, automated and manual, to perform the analysis. To execute both the approaches in parallel, some of the team members who got familiar with the automated code analysis tools will go ahead with the Magento code's installation and analysis with the automated code review tools. The rest of the team will go through the Magento issues and select a list of the CWE relevant to the existing cases. For selecting the CWE’s, we have even gone through a Scenario-based strategy that analyzes our previous Misuse and Assurance cases to match the possible attacks that can happen in the Magento system. By the end of the analysis of the issues, misuse cases, we ended up selecting 11 CWE that will be analyzed in the Magento code.

While coming to the automated code review, we researched the automated code review tools that will be the best fit for the Magento system as most of it is written in the Php. Most of the automated code analysis tools are only having commercial packages, which makes them out of our reach. But the automated code analysis tool that looked a perfect fit for our analysis was SonarQube. A community edition can be installed in our local machines and provides different features like issue review, security hotspots, etc. We haven’t solely relied on the SonarQube, we even tried to run the analysis on the SonarCloud, which is an online version of the SonarQube. Still, unfortunately, due to the Magento code's size, it is not possible to run the analysis in the SonarCloud. Then we explored other tools that are good at analyzing the Php code and ended up with the Codacy. The Codacy is a publicly available, online tool which can be used for static code analysis. So, both SonarQube and Codacy are mainly used to identify potential security concerns in the existing Magento codebase. On the whole, we have used both the automated and manual code review process to find the potential security issues based on the attacks that we have outlined in our misuse cases, assurance cases, and threat models.
